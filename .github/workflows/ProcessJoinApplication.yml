name: Process Join Application

on:
    issues:
        types: 
            - labeled

jobs:
    ProcessJoinApplication:
        runs-on: ubuntu-latest
        steps:
            - name: Check Label
              id: check-label
              uses: actions/github-script@v5
              with:
                  github-token: ${{ secrets.GITHUB_TOKEN }}
                  script: |
                    let labels = context.payload.issue.labels.map((label) => label.name);
                    let action = "none";
                    if (!labels.includes("Â· Join-application")) {
                      action = "none";
                    } else if (labels.includes("âˆš Approved")) {
                      action = "approved";
                    } else if (labels.includes("Ã— Rejected")) {
                      action = "rejected";
                    } else if (labels.includes("ğŸš§ Pending")) {
                      action = "none";
                    } else {
                      action = "welcome";
                    }
                    console.log("Issue Action: "+action);
                    core.setOutput("run-actions", action);
            - name: Welcome - Send Welcome Message
              if: steps.check-label.outputs.run-actions == 'welcome'
              uses: actions-cool/issues-helper@v3.4.0
              with:
                actions: 'create-comment'
                token: ${{ secrets.GITHUB_TOKEN }}
                issue-number: ${{ github.event.issue.number }}
                body: |
                  æˆ‘ä»¬å·²ç»æ”¶åˆ°äº†æ‚¨çš„ç”³è¯·ï¼Œå¹¶ä¼šå°½å¿«å¤„ç†ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚

                  å¦è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¦æ±‚æ‚¨æäº¤æ›´å¤šä¿¡æ¯ã€‚å› æ­¤ï¼Œè¯·å…³æ³¨æ‚¨çš„ GitHub ç»‘å®šé‚®ç®±é€šçŸ¥ã€‚
                  è‹¥æ‚¨æœªåœ¨ 24 å°æ—¶å†…å›å¤æˆ‘ä»¬çš„è¦æ±‚ï¼Œæˆ‘ä»¬å°†å…³é—­æ‚¨çš„ç”³è¯·ï¼Œä¸è¿‡æ‚¨è¿˜å¯ä»¥å†æ¬¡æäº¤ã€‚
            - name: Approved - Send Approved Message
              if: steps.check-label.outputs.run-actions == 'approved'
              uses: actions-cool/issues-helper@v3.4.0
              with:
                actions: 'create-comment'
                token: ${{ secrets.GITHUB_TOKEN }}
                issue-number: ${{ github.event.issue.number }}
                body: |
                  æ­å–œæ‚¨ï¼Œæˆ‘ä»¬å·²ç»åŒæ„æ‚¨çš„ç”³è¯·ï¼æ¬¢è¿åŠ å…¥ IT Craft Development Teamï¼
            - name: Approved - Close Issue As Completed
              if: steps.check-label.outputs.run-actions == 'approved'
              uses: actions-cool/issues-helper@v3.4.0
              with:
                actions: 'close-issue'
                token: ${{ secrets.GITHUB_TOKEN }}
                issue-number: ${{ github.event.issue.number }}
                close-reason: 'completed'
            - name: Rejected - Send Rejected Message
              if: steps.check-label.outputs.run-actions == 'rejected'
              uses: actions-cool/issues-helper@v3.4.0
              with:
                actions: 'create-comment'
                token: ${{ secrets.GITHUB_TOKEN }}
                issue-number: ${{ github.event.issue.number }}
                body: |
                  æ„Ÿè°¢æ‚¨å¯¹ IT Craft Development Team çš„å…´è¶£å’Œæ”¯æŒã€‚æˆ‘ä»¬å¾ˆé«˜å…´æ”¶åˆ°æ‚¨çš„åŠ å…¥ç”³è¯·ï¼Œä½†å¾ˆé—æ†¾åœ°é€šçŸ¥æ‚¨ï¼Œæ‚¨çš„ç”³è¯·æ²¡æœ‰é€šè¿‡ã€‚

                  æˆ‘ä»¬å¯»æ‰¾å…·æœ‰åˆ›æ–°èƒ½åŠ›æˆ–ä¸æˆ‘ä»¬å¿—åŒé“åˆçš„æˆå‘˜ã€‚æ ¹æ®æ‚¨æäº¤çš„ç”³è¯·ï¼Œæˆ‘ä»¬è®¤ä¸ºæ‚¨çš„æ€æƒ³æˆ–æŠ€èƒ½æ°´å¹³è¿˜ä¸ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ã€‚æˆ‘ä»¬å»ºè®®æ‚¨åœ¨ä»¥ä¸‹æ–¹é¢æé«˜è‡ªå·±ï¼š
                  
                  - æŒæ¡è‡³å°‘ä¸€ç§ä¸»æµç¼–ç¨‹è¯­è¨€ï¼Œå¦‚ Python, Java, Rust ç­‰ã€‚
                  - äº†è§£å¸¸ç”¨çš„è½¯ä»¶å¼€å‘å·¥å…·ï¼Œå¦‚ VSCode, Pycharm, IDEA ç­‰ã€‚
                  - å‚ä¸ä¸€äº›æœ‰åˆ›æ–°æ€§çš„é¡¹ç›®ï¼Œå±•ç¤ºæ‚¨çš„è§£å†³é—®é¢˜å’Œåä½œèƒ½åŠ›ã€‚
                  
                  æˆ‘ä»¬å¯¹æ‚¨çš„æœªæ¥å‘å±•è¡¨ç¤ºç¥ç¦ï¼Œå¹¶å¸Œæœ›æ‚¨èƒ½å¤Ÿç»§ç»­å…³æ³¨æˆ‘ä»¬çš„å›¢é˜ŸåŠ¨æ€ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘é—®æˆ–åé¦ˆï¼Œè¯·éšæ—¶è”ç³»æˆ‘ä»¬ã€‚
            - name: Rejected - Close Issue As Not Planned
              if: steps.check-label.outputs.run-actions == 'rejected'
              uses: actions-cool/issues-helper@v3.4.0
              with:
                actions: 'close-issue'
                token: ${{ secrets.GITHUB_TOKEN }}
                issue-number: ${{ github.event.issue.number }}
                close-reason: 'not_planned'
